# 计算机网络
# 目录（自底向上）
- 概述
- 物理层
- 数据链路层


# 第一章 概述
## 1.1 作用
#### 概述
- 网络：把许多计算机连接在一起
- 互联网：许多网络 把计算机连在一起
## 1.2 概述
#### 因特网发展的三个阶段
- 从单个网络向互联网络发展
  - internet（互连网）
  - Internet (专用，TCP/IP 协议，ARPANET前身)
- 建成三级结构的因特网（各网络利用路由器相连）
  - 主干网
  - 地区网
  - 校园网
- 从三级结构到多级结构的因特网（ISP结构的互联网）
  - ISP: Internet Service Provider 互联网服务提供商
  - 主干ISP，地区ISP，本地ISP
```
例如：中国电信，中国移动
```

## 1.3 因特网的组成
- **边缘部分**： **主机**
  - 用户直接使用
  - 客户服务器方式
  - 对等连接方式
- **核心部分**： **网络** + **路由器**
  - to 边缘: 服务

### 1.3.2 核心部分
##### 路由器
- 在核心部分起特殊作用
- 实现分组交换，转发收到的分组。

#### 1. 电路交换 的主要特点
- 电路交换：**建立连接** -> **通话**（一直占用资源） -> **释放连接**
- 特点：在通话的全部时间内，通话的两个用户始终占用端到端的通信资源。（**独占**）
- 效率低（突发性）
#### 2. 分组交换 的主要特点
```
报文：要发送的整块数据
首部：控制信息（地址信息，顺序信息）
分组 = 包 = 数据 + 首部： 互联网中传送的数据单元
分组的首部 = 包头
```
  - 采用**存储转发技术**
  - 分组在哪端链路，哪段链路才被占用时
  
##### 存储转发流程：
1. 收到分组，存储信息
2. 检查首部
3. 查找自身的转发表。 例如（C的转发表是：A,B,E)
4. 进行转发
5. 把分组交给下一个路由器

##### 分组交换流程：
1. 把报文划分成小段。
2. 添加首部，形成分组
3. 以分组为单位传输数据，发送到接收端。
4. 若数据没有出现差错，把首部剥去，重组报文。

- 原理：把较长的报文划分为较短的、固定长度的数据段。（要划分的原因：）
  - 出错后要重发
  - 存储不便
  - 会出现较大的延时


###### 分组交换 优点：
- **高效**，动态分配（不是始终占有）、
- **灵活**，分组查找路由
- **迅速**，不必先建立连接就能发送数据
- **可靠**，完善的协议

###### 分组交换 缺点：
- **开销**，携带首部，造成一定开销
- **时延**， 存储转发时，需要排队，有一定**时延**

重点：
- 分组交换是什么
- 存储转发和普通的区别是什么

#### 三种交换的比较
|电路交换|报文交换|分组交换|
|-------|--------|-------|
|建立**连接**，直达接收端|利用存储技术，发送**整篇**报文|利用存储技术，将报文**划分**，**分组发送**|

## 1.5 计算机网络的分类
### 1.5.2 不同类别的 计算机网络
#### 1. 作用范围
- **WAN** (Wide Area Network) 广域网：
  - xx - xxxx km
- **MAN** (Metropolitan Area Network) **城域网**：
  - 5-50km; 
  - 双总线
- **LAN** (Local Area Network) **局域网**：
  - 1km左右；
  - 单总线
- **PAN** (Personal Area Network) 个人区域网：
  - 10m
#### 2. 使用者
- 公用网
- 专用网
#### 3. 把用户接入到互联网的网络
- **AN** (Access Network) **本地接入网/居民接入网**：
  - 1km以内
  - 满足用户上网需求

## 1.6 计算机网络的性能
### 1. 速率
#### 数据传送速率
- **比特率** / 信息速率： 每秒钟能传输的二进制位数，单位**比特/秒（bps）**

```
k = 1000, M = 10^6 G = 10^9 T = 10^12 ...
```
#### 信号传输速率
- 每秒钟发送的码元数目
- 单位：Baud **波特**, 1Baud为每秒传输1个码元。
- 理想低通信道：信号的所有低频分量，只要频率不超过某个上限，都能够不失真地通过信道。
- 理想带通信道：信号的频率在某个范围F1～F2之间的频率分量能够不失真地通过信道，其它分量不能通过

#### 数据传输速率 和 信号传输速率
- 比特率 vs 波特率：$s = b*log_2{码元状态数N}$ 
##### 要点
  - 数据的传输速率“比特/秒”与码元的传输速率“波特”在数量上有一定的关系。
  - 若 1 个码元携带 n bit 的信息量，则M Baud 的码元传输速率所对应的信息传输速率为 M × n b/s。
```
> 判断：比特率总是大于等于波特率。（错误）比如：差分曼彻斯特码，归零码...
```

### 2. 带宽（重要！！！）
- 通信：
  - 信号具有的频带宽度。单位：赫
- 计网：
  - 网络中某通道**传送数据的能力**。
  - 在单位时间内网络中的某信道所能通过的“**最高数据率**”
  - 单位：bit/s
```
> 判断：
> - 在宽带线路上比特传播的快，在窄带线路上比比特传播的慢。（错误）
> - 宽带线路是指每秒有更多的比特从计算机注宽带线路是指每秒有更多的比特从计算机注入到线路上。（正确）
> - 宽带线路和窄带线路上比特的传播速率是一样的。（正确）
> - “光纤信道传输速率高”，是指向光纤信道发送数据的速率高，而不是指传播速率。（正确）
```

### 3. 吞吐量
- 单位时间内通过某个网络（或信道、接口）的实际数据量
- 单位：bit/s

### 4. 时延(重要！！！)
- 数据从网络的一段传送到另一端所需的时间。
#### 网络实验组成
- 总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延
- **发送时延 / 传输时延**：主机或路由器发送数据帧所需要的时间。（**上传时间**）
  - **发送时延 = 数据帧长度(bit) / 发送速率 (bit/s)**
- **传播时延**：电磁波在信道中传播一定的距离需要花费的时间。（**路上时间**）
  - **传播时延 = 信道长度（m）/ 电磁波在信道上的传播速率（m/s）**
- 处理时延
- 排队时延

### 5. 往返时间RTT
- 往返时延 RTT ：示从发送端发送数据开始，到发送端收到来自接收端的确认（接收端收到数据后立即发送确认），总共经历的时延。
### 6. 信道利用率
## 1.7 计算机网络的体系结构
### 1.7.1 网络的分层
- 分层原则：
  - 将网络按照功能分成一些列的层次，每一层完成一特定功能
  - 相邻层的较高层直接用较低层的服务来实现本层的功能，同时又为上层提供服务
  - 服务的提供和使用依靠相邻层的接口进行，各层只对相邻的上下层定义接口
`从一方顶层->底层，再从另一方底层->顶层`

### 1.7.2 协议与划分层次
- 网络协议：通信双方（或多方）关于如何进行通信的一种约定。

#### 网络协议 三要素
```
如何讲，讲什么，讲话次序
```
- **语法**：数据与控制信息的结构或格式
- **语义**：需要发出何种控制信息，完成何种动作以及做出何种响应
- **同步**：事件实现顺序的详细说明
#### 网络分层好处
- 各层之间是独立的
- 灵活性好
- 结构上可分割开
- 易于实现和维护
- 能促进标准化工作
#### 各层的功能
- 差错控制
- 流量控制
- 分段和重装
- 复用和分用
- 连接建立和释放
#### 体系结构
- 计算机网络的各层及其协议的集合
- 计算机网络及其构件所应完成的功能的精确定义


### 1.7.3 五层协议的体系结构
#### TCP/IP 参考模型
四层结构
- 应用层：各种应用服务
- 运输层：运输服务(TCP`可靠` / UDP`不可靠`)
- 网际层 IP：**无连接**分组交付服务 `OSI/SIO 有连接或者无连接可选`
- 网络接口层

五层结构
- 应用层
- 运输层
- 网络层
- 数据链路层
- 物理层

### 1.7.4 实体、协议、服务和服务访问点
- 实体：任何发送或接受信息的硬件或者软件进程
- 协议：在某个层上进行通信所使用的所有规则的集合
  - 向上层提供服务
  - “水平方向”

- SAP Service Access Point 服务访问站点
- SDU Service Data Unit 服务数据单元
- PDU Protocol Data Unit 协议数据单元
- 对于本层，PDU = 首部 + SDU
- 对上下层，第n层的SDU = 上一层的PDU

### 1.7.5 TCP/IP 
- everything over IP 
- IP over everything

```
### 网络参考模式
#### 各层的设计问题
- 地址问题
- 数据传送规则
  - 单工通信：单方向
  - 半双工通信：双方向，但不能同时
  - 全双工通信：双方向，能同时
#### ISO-OSI模型
> ISO International Standard Organization 国际标准化组织
> 
> OSI Open System Interconnection 开放系统互连
- 服务
- 接口
- 协议

**七层结构**：
  - 应用层、表示层、会话层、网络层、数据链路层、物理层

数据交换单位：
- 物理层，二进制流/比特流
- 数据链路层，对于二进制流增加开始和结束标志，称为帧
- 网络层，分组
- `>` 传输层，报文


OSI模式各层功能
- 物理层
- 数据链路层
- 网络层：路由、转发、拥塞控制
- 运输层（以上就变成端到端）：为会话层提供与下面网络无关的可靠消息传送机制
  - 第一个端到端的层次
- 会话层
- 表示层（数据表示相关）：两个应用层之间的传输过程中负责数据的表示语法
- 应用层：处理应用进程之间所发送和接受的数据中包含的信息
```