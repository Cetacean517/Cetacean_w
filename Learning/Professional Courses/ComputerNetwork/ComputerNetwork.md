# 计算机网络
# 目录（自底向上）
- 概述
- 物理层
- 数据链路层


# 第一章 概述
## 1.1 
### 1.1.2 计算机网络的发展过程
#### 因特网发展的三个阶段
- 从单个网络向互联网络发展
- 建成三级结构的因特网（各网络利用路由器相连）
  - 主干网
  - 地区网
  - 校园网
- 从三级结构到多级结构的因特网
### 1.1.3 因特网的组成
- 边缘部分
  - 客户服务器方式
  - 对等连接方式
- 核心部分

### 1.3.2 互联网的核心部分
- 在网络核心部分起特殊作用的是路由器。
- 路由器：实现分组交换，转发收到的分组。
  
#### **分组交换的主要特点**
- 分组交换采用**存储转发技术**
存储转发流程：
1. 存储信息
2. 查找自身的转发表。 例如（C的转发表是：A,B,E)
3. 进行转发

分组交换流程：
1. 把报文划分成小段。
2. 添加首部，形成分组
3. 以分组为单位传输数据，发送到接收端。
4. 若数据没有出现差错，把首部剥去，重组报文。


- 原理：把较长的报文划分为较短的、固定长度的数据段。（要划分的原因：）
  - 出错后要重发
  - 存储不便
  - 会出现较大的延时
- **分组 = 数据 + 首部。**
- 每个数据段前面，添加**首部**，包含：
  - 地址信息
  - 顺序信息...

优点：
- 高效，动态分配（不是始终占有）、
- 灵活，分组查找路由
- 迅速，不必先建立连接就能发送数据
- 可靠，完善的协议

问题：
- 携带首部，造成一定开销
- 存储转发时，需要排队，有一定时延

重点：
- 分组交换是什么
- 存储转发和普通的区别是什么

#### 三种交换的比较
|电路交换|报文交换|分组交换|
|-------|--------|-------|
|建立连接，直达接收端|利用存储技术，发送整篇报文|利用存储技术，将报文划分，分组发送|

## 1.2 计算机网络的分类
###
#### 1. 网络作用范围的划分
- LAN (Local Area Network) 局域网：1km左右；一条总线
- MAN (Metropolitan Area Network) 城域网：5-50km；两条总线
- WAN (Wide Area Network) 广域网：几十-几千km
- PAN (Personal Area Network) 个人区域网：10m

#### 把用户接入到互联网的网络
- AN (Access Network) 本地接入网/居民接入网：1km以内
  - 满足用户上网需求

## 1.3 计算机网络的体系结构
> 协议 protocol 
### 1.3.1 网络的分层
- 网络协议：通信双方（或多方）关于如何进行通信的一种约定。
- 协议分层
- 分层原则：
  - 将网络按照功能分成一些列的层次，每一层完成一特定功能
  - 相邻层的较高层直接用较低层的服务来实现本层的功能，同时又为上层提供服务
  - 服务的提供和使用依靠相邻层的接口进行，各层只对相邻的上下层定义接口
`从一方顶层->底层，再从另一方底层->顶层`
#### 网络分层好处
- 容易解决通信的异构性（heterogeneity）问题
- 上层解决不同种语言的相互翻译（数据的不同表示）；下层解决信息传递；使复杂问题简化，高层屏蔽低层细节问题
- 每层只关心本层的内容，不用知道其他层如何实现
- **使设计容易实现，每个层次向上一层提供服务，向下一层请求服务
**

### 网络协议的组成要素
> 如何讲，讲什么，讲话次序
- **语法**：数据与控制信息的结构或格式
- **语义**：需要发出何种控制信息，完成何种动
作以及做出何种响应
- **同步**：事件实现顺序的详细说明

### 网络的层、协议和接口
- 实体：
- 协议：在某个层上进行通信所使用的所有规则的集合。
--“水平方向”
  - 协议控制的是对等实体的通信规则
- 协议栈：
- SAP Service Access Point
- PDU Protocol Data Unit
- SDU Service Data Unit
- 对于本层，PDU = 首部 + SDU
- 对上下层，第n层的SDU = 上一层的PDU

#### 各层的设计问题
- 地址问题
- 数据传送规则
  - 单工通信：单方向
  - 半双工通信：双方向，但不能同时
  - 全双工通信：双方向，能同时
- 差错控制
- 顺序问题
- 流量控制
- 报文的分割和重组问题
- 多路复用和分用
- 路由

### 网络参考模式
#### ISO-OSI模型
> ISO International Standard Organization 国际标准化组织
> 
> OSI Open System Interconnection 开放系统互连
- 服务
- 接口
- 协议

**七层结构**：
  - 应用层、表示层、会话层、网络层、数据链路层、理层

数据交换单位：
- 物理层，二进制流/比特流
- 数据链路层，对于二进制流增加开始和结束标志，称为帧
- 网络层，分组
- `>` 传输层，报文


OSI模式各层功能
- 物理层
- 数据链路层
- 网络层：路由、转发、拥塞控制
- 运输层（以上就变成端到端）：为会话层提供与下面网络无关的可靠消息传送机制
  - 第一个端到端的层次
- 会话层
- 表示层（数据表示相关）：两个应用层之间的传输过程中负责数据的表示语法
- 应用层：处理应用进程之间所发送和接受的数据中包含的信息

面向连接服务与无连接服务
  - ...


#### TCP/IP 参考模型
四层结构
- 应用层：各种应用服务
- 运输层：运输服务(TCP`可靠` / UDP`不可靠`)
- 网际层 IP：**无连接**分组交付服务 `OSI/SIO 有链接或者无连接可选`
- 网络接口层

# 第二章 物理层
## 2.1 基本通信理论（**重点**）
### 2.1.1 数据通信的基本概念
#### 基本概念
- 信源：发送端
- 信宿：接收端
- 信道：通信线路

#### 术语解释
- 电信号分类
  - 模拟信号：联系变化的电压或电流波形
  - 数字信号：一系列表示：'0'和'1'的电脉冲
- 数据：运送信息的实体
- 信号：数据的电气或电磁的表现
- 模拟的：连续变化的
- 数字的：取指是离散数值
- 调制：数模转换的过程
- 解调：模数转换过程
  
### 2.1.2 数据通信中的几个指标
#### 重要指标
- 信号传输速率
- 数据传输速率
- 信道容量
  - 无噪声
  - 有噪声
- **带宽**（重要指标）
- **时延**（重要指标）
- 误码率

#### 信号传输速率
- 每秒钟发送的码元数目
- 单位：Baud **波特**, 1Baud为每秒传输1个码元。
- 理想低通信道：信号的所有低频分量，只要频率不超过某个上限，都能够不失真地通过信道。
- 理想带通信道：信号的频率在某个范围F1～F2之间的频率分量能够不失真地通过信道，其它分量不能通过
- **信道的带宽**：
  - 信道所能传输的电信号的**频率范围**，单位为赫兹。（模拟信号频率大小）
  - vs计算机网络中的带宽，使用的bit/s(每秒钟传送多少位0/1)
- **奈氏准则**：
  - 在带宽为W(Hz)的低通信道中，若不考虑噪声影响，则码元传输的最高速率是2W(码元/秒)。
  - 传输速率超过此上限，就会出现严重的码间串扰问题，使接收端对码元的判决（即识别）成为不可能。

#### 数据传送速率
- 每秒钟能传输的二进制位数，单位**比特/秒（bps）**，数据传输速率又称为比特率 / 信息速率。
- 一般情况：若码元状态数为N，则比特率和波特率的关系为：$s = b*log_2{N}$
- **要点**
  - 数据的传输速率“比特/秒”与码元的传输速率,“波特”在数量上却有一定的关系。
  - 若 1 个码元携带 n bit 的信息量，则M Baud 的码元传输速率所对应的信息传输速率为 M × n b/s。
> 判断：比特率总是大于等于波特率。（错误）
> 特例:

#### 信道容量
- 信道的极限信息数据传输速率：表示信道传输数字信号的能力，是信道所能支持的数据速率的上限。
- 对于无噪声信道
  - 信道的极限信息数据传输速率
  - 表示信道传输数字信号的能力，是信道所能支持的数据速率的上限。
  - 无噪声信道的容量是无限的。
  - 根据奈奎斯特定理：
    - $B=2H（baud）$ 
  - 信道的最大数据传输速率：
    - $S=B*Log_2N$
  - 所以有：
    - $S=2H*Log2N (bps)$
- 对于有噪声信道：
  - 信道不能无限延长
  - 信道容量：
    - $C = H log_{2}(1+S/N) (bps)$ 
    - H：信道的带宽（单位：Hz)
    - S：信号功率
    - N：噪声功率
    - S/N为：信道的信噪比
- 香农公式结论
  - 信道的带宽或信道中的信噪比越大，信息的极限传输速率就越高
  - 香农公式指出了信息传输速率的上限
  - 只要信息传输速率低于信道的极限信息传输速率，就一定可以找到某种办法来实现无差错的传输

#### 带宽
- **(原来)信号的带宽：信号各种不同频率成分所占据的评率范围。
- （现在）带宽：数据最高传输速率
- 单位：bit/s,kb/s,Mb/s...
- 传播速率 vs 传输速率
  - 传播速率：数据传播的速率
  - 传输速率：把bit放在线路上
> 判断：
> - 在宽带线路上比特传播的快，在窄带线路上比比特传播的慢。（错误）
> - 宽带线路是指每秒有更多的比特从计算机注宽带线路是指每秒有更多的比特从计算机注入到线路上。（正确）
> - 宽带线路和窄带线路上比特的传播速率是一样的。（正确）
> - “光纤信道传输速率高”，是指向光纤信道发送数据的速率高，而不是指传播速率。（正确）

#### 时延
- 一个报文或分组从一个网络（或一条链路）的一端传送到另一端所需的时间。
- 分类
  - 发送（/传输）时延：结点发送数据时使数据块从结点到传输媒体（`出门的时间，与门的大小和班级人数有关`)
    - 信道带宽：数据在信道上发送速率，称为数据在信道上的传输速率。
    - 发送时延 = （数据块长度（bit））/ （信道带宽（bit/s））
  - 传播时延：电磁波传播时延（`路上的时间，与路的距离和走路速度有关`)
  - 处理时延：排队，处理（存储、转发）等
    - 处理时延的长短往往取决于网络中当时的通信量
- 总时延 = 发送时延 + 传播时延 + 处理时延
- 往返时延 RTT ：示从发送端发送数据开始，到发送端收到来自接收端的确认（接收端收到数据后立即发送确认），总共经历的时延。

#### 误码率
- 传输出错的码元数占传输总码元数的比例。
- 衡量数据通信系统在正常工作情况下传输可靠性的指标。
- 误码率Pe = Ne / N 
  - N：传输总的码元数
  - Ne：传输出错的码元数
- 应用：决定传输的数据单元大小。

### 2.1.3 数字调制技术
- 在计算机提供的二进制数字信号与电话网提
供的模拟信号之间进行转换。
#### 连续波数字信号调制
- 基带信号：来自信源的信号。`将数字信号 1 或 0 直接用两种不同的电压来表示，然后送到线路上去传输。`
- 宽带信号：将基带信号进行调制后形成的频分复用模拟信号。
- 调制：在发送端将基带信号转换成适合传输的音频信号
- 解调：在接收端再将音频信号转换成基带信号
> 为什么需要数字信号调制？
> 因为基带信号仅适合短距离的数据传输。在计算机的远程通信中，不能直接传输原始的电脉冲信号。
> 所以，需要Modem，在发送端将基带信号转换成适合传输的音频信号;并在接收端再将音频信号转换为基带信号。
- 调制方法
  - 选取一个适合在线路上传输的正弦波作为载波，让载波的某些特性随基带信号变化而变化

##### 几种最基本的调制方法
- 调制就是进行波形变换（频谱变换）。
- 最基本的二元制调制方法（详见ppt）
  - 振幅键控
  - 频移键控
  - 相位键控

##### 振幅键控
- 载波的**振幅**随基带数字信号而变化
- 实现简单，抗干扰性差
##### 频移键控
- 载波的**频率**随基带数字信号而变化
- 抗干扰性好，占用带宽较大
##### 相位键控
- 载波的**初始相位**随基带数字信号而变化
- 可以用初始相位 / 相位变化表示 0 和 1 值。
##### 相移键控
- 载波的相位（绝对值或变化）来表示数据

##### 脉冲编码调制PCM
- 模拟信号 -> 数字信号
- 采样 -> 



#### 调制解调器的作用
- 调制器：
  - 把要发送的数字信号转换为频率范围在300~3400 Hz 之间的模拟信号，以便在电话用户线上传送。
  - 波形变换器
- 解调器：
  - 把电话用户线上传送来的模拟信号转换为数字信号。
  - 波形识别器

### 2.1.4 多路复用技术
  将多路信号组合在一条物理信道上进行传输，在接收端再将各路信号分离开来，提高通信线路的利用率
- 频分多路复用
- 时分多路复用
- 波分多路复用
- 码分多路复用 CDMA (Code Division Multiple Access)

#### 频分多路复用 FDM
- 频谱：信号的能量随频率的分布规律为信号的频谱。
- 信号的带宽：能量集中的区域为信号的带宽。
- FDM：当信道的带宽大于各路信号的总带宽时，可以将信道分割
成若干个子信道，每个子信道用来传输一路信号。
> 车道大于车流量时，分多车道同行。
> 同时传输多路信道

- ADSL 非对称数字用户线路（上下行速率不对称，v下 >> v上）
  - e.g. 用电话线上网

#### 时分多路复用 TDM
- 隔时间片，分配给各路信号，每一路信号在自己的时间片内**独占**整个信道。
- 时间片大小：按一个数据块传输时间确定
> 类似北京的单双号限行。
> 轮流占有信道，通信时独占一整个信道
##### TDM类型
- 同步TDM
  - 优点：控制简单
  - 缺点：信道利用不充分。`某信号源没有数据，仍会占用时间片。`
- 异步TDM：统计时分复用STDM
  - 优点：充分利用信道
  - 控制比较复杂

#### 波分多路复用
#### 码分多路复用 
- 每个用户在**同样时间**使用**同样频率**进行通信。
- 挑选**不同码型**，所以不产生干扰。
- 每一个比特时间划分为 m 个短的间隔，称为码片(chip)。 m通常为64或128.

##### CDMA 的重要特点
- 每个站分配的码片序列不仅必须各不相同，并且还必须互相**正交**(orthogonal)
  - 正交：两个站（S和T）的码片内积为0。 S · T = 0
  - S · (+/- T) = 0
  - S · S = 1
  - S · (-S) = -1
- 当接收站打算接收S站的信号时，就用S站的码片序列与收到的叠加信号求规格化内积
  - **若S站有信号发送**，则内积结果为1(发送数据1)或-1（发送数据0）
  - **若S站没有信号发送**，则内积结果为0
- **两种题型**
  - 已知发送站点的码片序列S_i,每个站是否发送，且送了0或1，求接收端收到的叠加信号。
> 发送1，发送原值；发送0，发送相反值
> 最后，全加起来
  - 已知发送站点的码片序列R, 已知接收端的叠加信号S_i，求每个站的发送情况


### 2.1.5 数字信号编码
- 单极性码
- 双
- 不归零码
  - 连续传输，不易区分0和1
- 归零码
  - 连续传输，可以区分0和1
- 曼彻斯特码
  - 低 -> 高：1；高 -> 低：0
- 差分曼彻斯特
  - 无跳变：1；有跳变：0
> 如果码元传输速率= 10Mbps 
> 由于一位bit,同时传输+3V和-3V的码元。
> 那么波特传输速率 = 20M Baud

## 2.2 物理层
### 传输介质
#### **导向性传输媒体**
##### 双绞线
- 屏蔽双绞线 STP
- 无屏蔽双绞线 UTP
##### 同轴电缆
- 基带同轴电缆
- 宽带同轴电缆
##### 光缆（**分类要记！！！**）
- 特点：
  - 优点：
    - 通信损耗低
    - 频带宽
    - 数据传输速率高
    - 抗电磁干扰好，安全性好
  - 缺点：
    - 价格昂贵
- **多模光纤**：
  - 一根光纤可以传送多条管线（原理：全反射）
  - 传输过程，光脉冲逐渐宽展，造成失真。适合短距离
- **单模光纤**
  - 适合长距离传输
#### **非导向性传输媒体**
- 用 *自由空间* 作为传输介质来进行数据通信。
- 特点
  - 信号方向性较强
  - 沿直线传播,不能绕开固体障碍物
- 分类
  - 地面微波接力通信
  - 卫星通信
  - 红外线
  - 毫米波通信
##### 微波接力通信
- 优点: 
  - 频带宽, 通信容量大
  - 传输质量高, 可靠性较好
  - 投资少、见效快、灵活
- 缺点:
  - 相邻站间必须直视，不能有障碍物
  - 受气候干扰较大
  - 保密性差
  - 中继站的使用与维护

##### 卫星通信
- 优点：
  - 频带很宽, 通信容量大，信号受干扰小
  - 通信比较稳定,通信距离远
- 缺点：
  - 保密性较差，造价较高
  - 具有较大的传输延迟

##### 红外线与毫米波通信
- 优点：
  - 价格便宜，易制造
  - 有良好的安全性，不易被窃听
- 缺点：
  - 不能穿透坚硬的物体，对环境气候敏

** 2.4G ~ 2.484GHz开放给医学科学使用，不需要审批。容易产生干扰。
## 2.3 同步光纤网和同步数字系列
### 早期缺点
- 速率标准不统一
- 不是同步传输
### SONET标准
> 为了设定全球传输的速度标准
- 传输基本速率 = 51.84 Mb/s
  - 电信号：第1级同步传送信号 STS-1
  - 光信号：第1级光载波 OC-1 
### SDH（同步数字系列）标准
> STS-1速度的3倍
- 传输基本速率/第1级同步传递模块 = 155.52 Mb/s

### SONET与SDH的关系
- 差别很小
- SONET：北美和日本
- SDH：欧洲和中国
- 采用TDM技术；同步系统，由主时钟控制

### 意义
- 使北美、日本和欧洲等不同的数字传输体制在STM-1等级上获得了统一。
- SDH/SONET是第一次真正实现数字传输体制上的国际标准

## 2.4 物理层协议举例
### **物理层特性**（要记！！）
- 机械特性
  - 接口所用接线器的形状和尺寸、引线书目和排列、固定和锁定装置
- 电器特性
  - 接口电缆的各条线上出现的电压的范围。
- 功能特性
  - 某一电平的电压表示何种意义
- 规程特性
  - 不同功能的各种可能事件的出现顺序

### EIA-232-E接口标准
- 规定了DTE和DCE间的接口标准
- DTE：数据中断设备（可以理解为计算机）
- DCE：数据电路端接设备（可以理解为调制解调器）

#### 机械特性
#### 规程特性
> 定义流程，DTE和DCE如何交流的.
- EIA232规定了DTE和DCE之间的信号时序的应答关系和操作过程。

### RS-449接口标准
- 传输速率可达到48~168kb/s

# 第三章 
